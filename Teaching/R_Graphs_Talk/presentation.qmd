---
draft: true
title: "Graphs and data analyses in R"
author: "Arthur Oulès"
date: "01/12/2026"
date-format: long
width: 1920
height: 1080
freeze: auto
format:
  revealjs:
    theme: dark
    slide-number: true
    footer: "*R graph capabilities 12/01/2026*"
    code-block-height: 950px
    css: styles.css
editor: source
---

```{r}
#| label: load-packages
#| echo: false
#| eval: true

library(here)
library(tidyverse)
library(knitr)
library(patchwork)
# library(magick)
```

```{r}
#| echo: false
#| eval: true

theme_custom <- function() {
  ggplot2::theme_dark() +
  ggplot2::theme(
    text              = element_text(colour = "#7f7f7f"),
    axis.text         = element_text(colour = "#7f7f7f"),
    # panel.grid        = element_line(colour = "#2b2b2b"),
    plot.background   = element_rect(fill = "#191919", colour = "#191919"),
    # panel.background  = element_rect(fill = "#191919"),
    legend.background = element_rect(fill = "#191919", colour = "#191919")
    # strip.background  = element_rect(fill = "#191919"),
    # strip.text        = element_text(colour = "#ffffff")
  )
}
```

## What is R?

::: incremental
-   Programming language and opensource software based on `Fortran` and `C`

-   Maintained by *The R Foundation*, not-for-profit

-   Designed for statistical computing and data visualisation
:::

:::: fragment
![](images/RGUI.png){fig-align="center"}

::: {.centertext .smalltext}
*R's not-so-user-friendly Graphical Interface*
:::
::::

## An example of a quick R graph

```{r}
#| echo: true
#| fig-align: "center"

blackcap_2024 <- read.csv(here("data", "table_birds_2024.csv"))

boxplot(
  CRIS ~ DIFFUSION,
  data = blackcap_2024,
  xlab = "Type de Diffusion",
  ylab = "Nombre de Cris"
)
title("Nombre de cris en réponse à différents types de diffusion")
```

## The R inferno

![](images/R_Inferno.png){fig-align="center"}

::: {.centertext .smalltext}
[*https://www.burns-stat.com/pages/Tutor/R_inferno.pdf*](https://www.burns-stat.com/pages/Tutor/R_inferno.pdf){.uri}
:::

## What is Posit?

It is and open-source data science software company

![](images/BLOG-posit-rebrand2022.jpg){.nostretch fig-align="center" width="60%"}

## RStudio

::::::::::::: columns
:::::::::: {.column width="30%"}
It's an Integrated Development Environment (IDE) from where you have access:

::: {.fragment .highlight-current-red fragment-index="1"}
-   Your Code
:::

::: {.fragment .highlight-current-red fragment-index="2"}
-   A R/Python console and terminal
:::

::: {.fragment .highlight-current-red fragment-index="3"}
-   A File explorer
:::

::: {.fragment .highlight-current-red fragment-index="4"}
-   To help
:::

::: {.fragment .highlight-current-red fragment-index="5"}
-   Plots/Presentation/Report Viewer
:::

::: {.fragment .highlight-current-red fragment-index="6"}
-   To Memory Management
:::

::: {.fragment .highlight-current-red fragment-index="7"}
-   Version Control (*e.g.* Git)
:::
::::::::::

:::: {.column width="70%"}
::: r-stack
![](images/Rstudio.png)

![](images/Rstudio_code.png){.fragment fragment-index="1"}

![](images/Rstudio_console.png){.fragment fragment-index="2"}

![](images/Rstudio_files.png){.fragment fragment-index="3"}

![](images/Rstudio_help.png){.fragment fragment-index="4"}

![](images/Rstudio_viewer.png){.fragment fragment-index="5"}

![](images/Rstudio_env.png){.fragment fragment-index="6"}

![](images/Rstudio_git.png){.fragment fragment-index="7"}
:::
::::
:::::::::::::

## Project-based programming

![](images/project.png)

## The Tidyverse {auto-animate="true"}

![](images/Tidyverse.png)

## The Tidyverse {auto-animate="true"}

::::: columns
::: column
\
\

-   `tibble`: A package introducing a new type of dataframe

-   `readr`: A package to read multiple file formats to tibbles

-   `tidyr`: A package to reformat raw data to a ggplot2-friendly format

-   `ggplot2`: A packagage for creating graphics
:::

::: column
![](images/Tidyverse.png)
:::
:::::

## `tidyr`&`dplyr` {auto-animate="true"}

![](images/pipeoperator_Selina_Cheng.png){fig-align="center"}

::: {.centertext .smalltext}
*The pipe operator and tidyr.* Credit: [Selina Cheng](https://www.rforecology.com/post/how-to-use-pipes/)
:::

## `tidyr`&`dplyr` {auto-animate="true"}

:::::: columns
:::: column
![](images/pipeoperator_Selina_Cheng.png){fig-align="center"}

::: {.centertext .smalltext}
*The pipe operator and tidyr.* Credit: [Selina Cheng](https://www.rforecology.com/post/how-to-use-pipes/)
:::
::::

::: column
\
\
\
\

```{r}
#| echo: true
#| eval: false

object |> function(...)

function(arg1 = object, ...)
```
:::
::::::

## `ggplot2` {auto-animate="true"}

![](images/ggplot2.png){.nostretch fig-align="center" width="400px"}

::: centertext
[`ggplot2`](https://ggplot2.tidyverse.org/) is an R package allowing the production of graphics using "The Grammar or Graphics".
:::

## `ggplot2` {auto-animate="true"}

::::: columns
::: {.column width="50%"}
![](images/ggplot2.png){fig-align="center"}

[`ggplot2`](https://ggplot2.tidyverse.org/) is an R package allowing the production of graphics using "The Grammar or Graphics".
:::

::: {.column width="50%"}
![](images/ggplot2_layers_dark.svg)
:::
:::::

# Practical applications

## Getting the data {auto-animate="true"}

![](images/exc_hell.png)

## Make the Data R-friendly {auto-animate="true"}

![](images/nice_csv.png){fig-align="center"}

## Loading the data {auto-animate="true"}

```{r}
#| echo: true
#| eval: true

blackcap_2024 <- read_csv(here("data", "table_birds_2024.csv")) 
  
```

```{r}
kable(head(blackcap_2024))
```

## "Tidying" the data {auto-animate="true"}

```{r}
#| echo: true
#| eval: true

blackcap_2024_refactor <- blackcap_2024 |> 
  mutate(
    DIFFUSION = DIFFUSION |>
      factor(
        levels = c("MC", "FT_comp", "FT_sif", "FT_gaz", "FG", "FJ")
      )
  )
```

```{r}
kable(head(blackcap_2024_refactor ))
```

## Initialising the plot panel {auto-animate="true"}

::::: columns
::: {.column width="50%"}
```{r}
#| echo: true
#| eval: false
#| code-line-numbers: "2"

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_jitter(alpha = .15) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  facet_grid(rows = vars(ID_MALE)) +
  theme_custom() +
  theme(
    axis.title.x    = element_blank(),
    axis.text.x     = element_text(angle = 45, hjust = 1, vjust = 1),
    legend.position = "bottom",
  )
```
:::

::: {.column width="50%"}
```{r}
#| fig-height: 8
#| fig-width: 6

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS))
```
:::
:::::

## Plotting points {auto-animate="true"}

::::: columns
::: {.column width="50%"}
```{r}
#| echo: true
#| eval: false
#| code-line-numbers: "3"

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_jitter(alpha = .15) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  facet_grid(rows = vars(ID_MALE)) +
  theme_custom() +
  theme(
    axis.title.x    = element_blank(),
    axis.text.x     = element_text(angle = 45, hjust = 1, vjust = 1),
    legend.position = "bottom",
  )
```
:::

::: {.column width="50%"}
```{r}
#| fig-height: 8
#| fig-width: 6

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_jitter(alpha = .15)

```
:::
:::::

## Plotting distributions as coloured boxplots {auto-animate="true"}

::::: columns
::: {.column width="50%"}
```{r}
#| echo: true
#| eval: false
#| code-line-numbers: "4"

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_jitter(alpha = .15) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  facet_grid(rows = vars(ID_MALE)) +
  theme_custom() +
  theme(
    axis.title.x    = element_blank(),
    axis.text.x     = element_text(angle = 45, hjust = 1, vjust = 1),
    legend.position = "bottom",
  )
```
:::

::: {.column width="50%"}
```{r}
#| fig-height: 8
#| fig-width: 6

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_jitter(alpha = .15) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE)
```
:::
:::::

## Separating the different categories {auto-animate="true"}

::::: columns
::: {.column width="50%"}
```{r}
#| echo: true
#| eval: false
#| code-line-numbers: "5"

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_jitter(alpha = .15) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  facet_grid(rows = vars(ID_MALE)) +
  theme_custom() +
  theme(
    axis.title.x    = element_blank(),
    axis.text.x     = element_text(angle = 45, hjust = 1, vjust = 1),
    legend.position = "bottom",
  )
```
:::

::: {.column width="50%"}
```{r}
#| fig-height: 8
#| fig-width: 6

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_jitter(alpha = .15) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  facet_grid(rows = vars(ID_MALE))
```
:::
:::::

## Tuning theme {auto-animate="true"}

::::: columns
::: {.column width="50%"}
```{r}
#| echo: true
#| eval: false
#| code-line-numbers: "6"

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_jitter(alpha = .15) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  facet_grid(rows = vars(ID_MALE)) +
  theme_custom() +
  theme(
    axis.title.x    = element_blank(),
    axis.text.x     = element_text(angle = 45, hjust = 1, vjust = 1),
    legend.position = "bottom",
  )
```
:::

::: {.column width="50%"}
```{r}
#| fig-height: 8
#| fig-width: 6

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_jitter(alpha = .15) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  facet_grid(rows = vars(ID_MALE)) +
  theme_custom()
```
:::
:::::

## Removing redondant information {auto-animate="true"}

::::: columns
::: {.column width="50%"}
```{r}
#| echo: true
#| eval: false
#| code-line-numbers: "6-10"

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_jitter(alpha = .15) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  facet_grid(rows = vars(ID_MALE)) +
  theme_custom() +
  theme(
    axis.title.x    = element_blank(),
    axis.text.x     = element_text(angle = 45, hjust = 1, vjust = 1),
    legend.position = "bottom",
  )
```
:::

::: {.column width="50%"}
```{r}
#| fig-height: 8
#| fig-width: 6

blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_jitter(alpha = .15) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  facet_grid(rows = vars(ID_MALE)) +
  theme_custom() +
  theme(
    axis.title.x    = element_blank(),
    axis.text.x     = element_text(angle = 45, hjust = 1, vjust = 1),
    legend.position = "bottom",
  )
```
:::
:::::

## The Extra Step {auto-animate="true"}

::::: columns
::: {.column width="50%"}
```{r}
#| echo: true
#| eval: false

blackcap_tot_plot <- blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  geom_jitter(alpha = .15)

blackcap_nonzero_plot <- blackcap_2024_refactor |>
  filter(CRIS != 0) |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  geom_jitter(alpha = .15)

blackcap_IDs_plot <- blackcap_2024 |> 
  mutate(
    DIFFUSION = DIFFUSION |>
      factor(
        levels = c("MC", "FT_comp", "FT_sif", "FT_gaz", "FG", "FJ")
      )
  ) |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  geom_jitter(alpha = .15) +
  facet_grid(rows = vars(ID_MALE))

((blackcap_tot_plot / blackcap_nonzero_plot) | blackcap_IDs_plot) +
  plot_layout(guides = "collect")  +
  plot_annotation(tag_levels = "A") &
  theme_custom() &
  theme(
    axis.title.x    = element_blank(),
    axis.text.x     = element_text(angle = 45, hjust = 1, vjust = 1),
    legend.position = "bottom",
    plot.tag = element_text(face = "bold", colour = "white")
  )
```
:::

::: {.column width="50%"}
```{r}
#| fig-height: 8
#| fig-width: 6

blackcap_2024_refactor <- here("data", "table_birds_2024.csv") |> 
  read_csv() |> 
  mutate(
    DIFFUSION = DIFFUSION |>
      factor(
        levels = c("MC", "FT_comp", "FT_sif", "FT_gaz", "FG", "FJ")
      )
  )

blackcap_tot_plot <- blackcap_2024_refactor |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  geom_jitter(alpha = .15)

blackcap_nonzero_plot <- blackcap_2024_refactor |>
  filter(CRIS != 0) |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  geom_jitter(alpha = .15)

blackcap_IDs_plot <- blackcap_2024 |> 
  mutate(
    DIFFUSION = DIFFUSION |>
      factor(
        levels = c("MC", "FT_comp", "FT_sif", "FT_gaz", "FG", "FJ")
      )
  ) |> 
  ggplot(aes(x = DIFFUSION, y = CRIS)) +
  geom_boxplot(aes(fill = DIFFUSION), alpha = .75, outliers = FALSE) +
  geom_jitter(alpha = .15) +
  facet_grid(rows = vars(ID_MALE))

((blackcap_tot_plot / blackcap_nonzero_plot) | blackcap_IDs_plot) +
  plot_layout(guides = "collect")  +
  plot_annotation(tag_levels = "A") &
  theme_custom() &
  theme(
    axis.title.x    = element_blank(),
    axis.text.x     = element_text(angle = 45, hjust = 1, vjust = 1),
    legend.position = "bottom",
    plot.tag = element_text(face = "bold", colour = "white")
  )
```
:::
:::::

## Complex Figures

![](images/EJA_flex.jpg){fig-align="center"}

::: {.centertext .smalltext}
Genetic population structure of the Black Surfperch *Embiotoca jacksoni*. DOI: [10.1111/mec.70073](https://www.doi.org/10.1111/mec.70073)
:::

## Quarto: a Complete Environment for Researchers

::: r-stack
```{=html}
<iframe width="1600" height="900" src="https://arthur-oules.github.io/about.html" title="Webpage example"></iframe>
```
:::
